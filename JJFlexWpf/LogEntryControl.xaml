<UserControl x:Class="JJFlexWpf.LogEntryControl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             mc:Ignorable="d"
             d:DesignHeight="500" d:DesignWidth="450"
             Focusable="True"
             PreviewKeyDown="UserControl_PreviewKeyDown">
    <DockPanel LastChildFill="True">
        <!-- Top: Entry fields (fixed height) -->
        <Grid DockPanel.Dock="Top" Margin="4">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="80"/>
                <ColumnDefinition Width="150"/>
                <ColumnDefinition Width="10"/>
                <ColumnDefinition Width="70"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
            <Grid.RowDefinitions>
                <RowDefinition Height="28"/>
                <RowDefinition Height="28"/>
                <RowDefinition Height="28"/>
                <RowDefinition Height="28"/>
                <RowDefinition Height="28"/>
                <RowDefinition Height="28"/>
                <RowDefinition Height="28"/>
                <RowDefinition Height="28"/>
                <RowDefinition Height="28"/>
                <RowDefinition Height="20"/>
                <RowDefinition Height="20"/>
                <RowDefinition Height="20"/>
                <RowDefinition Height="20"/>
            </Grid.RowDefinitions>

            <!-- Row 0: Call Sign -->
            <Label Content="Call Sign" Target="{Binding ElementName=CallSignBox}" Grid.Row="0" Grid.Column="0" VerticalAlignment="Center"/>
            <TextBox x:Name="CallSignBox" Grid.Row="0" Grid.Column="1"
                     AutomationProperties.Name="Call Sign"
                     TabIndex="0" VerticalAlignment="Center"
                     LostFocus="CallSignBox_LostFocus"/>

            <!-- Row 1: RST Sent / RST Rcvd / Dup -->
            <Label Content="RST Sent" Target="{Binding ElementName=RSTSentBox}" Grid.Row="1" Grid.Column="0" VerticalAlignment="Center"/>
            <TextBox x:Name="RSTSentBox" Grid.Row="1" Grid.Column="1" Width="60" HorizontalAlignment="Left"
                     AutomationProperties.Name="RST Sent"
                     TabIndex="1" VerticalAlignment="Center"/>
            <Label Content="RST Rcvd" Target="{Binding ElementName=RSTRcvdBox}" Grid.Row="1" Grid.Column="3" VerticalAlignment="Center"/>
            <StackPanel Orientation="Horizontal" Grid.Row="1" Grid.Column="4" VerticalAlignment="Center">
                <TextBox x:Name="RSTRcvdBox" Width="60"
                         AutomationProperties.Name="RST Received"
                         TabIndex="2" VerticalAlignment="Center"/>
                <TextBlock x:Name="DupLabel" Text="Dup: 0" Margin="10,0,0,0" VerticalAlignment="Center"
                           AutomationProperties.Name="Duplicate count"/>
            </StackPanel>

            <!-- Row 2: Name -->
            <Label Content="Name" Target="{Binding ElementName=NameBox}" Grid.Row="2" Grid.Column="0" VerticalAlignment="Center"/>
            <TextBox x:Name="NameBox" Grid.Row="2" Grid.Column="1" Grid.ColumnSpan="4"
                     AutomationProperties.Name="Name"
                     TabIndex="3" VerticalAlignment="Center"/>

            <!-- Row 3: QTH -->
            <Label Content="QTH" Target="{Binding ElementName=QTHBox}" Grid.Row="3" Grid.Column="0" VerticalAlignment="Center"/>
            <TextBox x:Name="QTHBox" Grid.Row="3" Grid.Column="1" Grid.ColumnSpan="4"
                     AutomationProperties.Name="QTH"
                     TabIndex="4" VerticalAlignment="Center"/>

            <!-- Row 4: State / Grid -->
            <Label Content="State" Target="{Binding ElementName=StateBox}" Grid.Row="4" Grid.Column="0" VerticalAlignment="Center"/>
            <TextBox x:Name="StateBox" Grid.Row="4" Grid.Column="1" Width="50" HorizontalAlignment="Left"
                     AutomationProperties.Name="State"
                     TabIndex="5" VerticalAlignment="Center"/>
            <Label Content="Grid" Target="{Binding ElementName=GridBox}" Grid.Row="4" Grid.Column="3" VerticalAlignment="Center"/>
            <TextBox x:Name="GridBox" Grid.Row="4" Grid.Column="4" Width="70" HorizontalAlignment="Left"
                     AutomationProperties.Name="Grid Square"
                     TabIndex="6" VerticalAlignment="Center"/>

            <!-- Row 5: Comments -->
            <Label Content="Comments" Target="{Binding ElementName=CommentsBox}" Grid.Row="5" Grid.Column="0" VerticalAlignment="Center"/>
            <TextBox x:Name="CommentsBox" Grid.Row="5" Grid.Column="1" Grid.ColumnSpan="4"
                     AutomationProperties.Name="Comments"
                     TabIndex="7" VerticalAlignment="Center"/>

            <!-- Row 6: Previous Contact (read-only, tabbable) -->
            <Label Content="Previous" Target="{Binding ElementName=PreviousContactBox}" Grid.Row="6" Grid.Column="0" VerticalAlignment="Center"/>
            <TextBox x:Name="PreviousContactBox" Grid.Row="6" Grid.Column="1" Grid.ColumnSpan="4"
                     IsReadOnly="True" BorderThickness="0"
                     Background="{x:Static SystemColors.ControlBrush}"
                     AutomationProperties.Name="Previous contact: none"
                     AutomationProperties.LiveSetting="Polite"
                     TabIndex="8" VerticalAlignment="Center"/>

            <!-- Row 7-8: empty space -->

            <!-- Row 9: Freq -->
            <TextBlock x:Name="FreqLabel" Text="Freq: ---" Grid.Row="9" Grid.Column="0" Grid.ColumnSpan="5"
                       AutomationProperties.Name="Frequency" VerticalAlignment="Center" Margin="4,0,0,0"/>

            <!-- Row 10: Mode / Band -->
            <StackPanel Orientation="Horizontal" Grid.Row="10" Grid.Column="0" Grid.ColumnSpan="5" Margin="4,0,0,0">
                <TextBlock x:Name="ModeLabel" Text="Mode: ---" AutomationProperties.Name="Mode"/>
                <TextBlock x:Name="BandLabel" Text="Band: ---" AutomationProperties.Name="Band" Margin="20,0,0,0"/>
            </StackPanel>

            <!-- Row 11: UTC -->
            <TextBlock x:Name="DateTimeLabel" Text="UTC: ---" Grid.Row="11" Grid.Column="0" Grid.ColumnSpan="5"
                       AutomationProperties.Name="Date and Time UTC" VerticalAlignment="Center" Margin="4,0,0,0"/>

            <!-- Row 12: Serial -->
            <TextBlock x:Name="SerialLabel" Text="Serial: 0" Grid.Row="12" Grid.Column="0" Grid.ColumnSpan="5"
                       AutomationProperties.Name="Serial number" VerticalAlignment="Center" Margin="4,0,0,0"/>
        </Grid>

        <!-- Bottom: Recent QSOs DataGrid (fills remaining space) -->
        <DockPanel Margin="4,4,4,4">
            <TextBlock DockPanel.Dock="Top" Text="Recent QSOs" FontWeight="Bold" FontSize="12" Margin="0,0,0,4"/>
            <DataGrid x:Name="RecentGrid"
                      IsReadOnly="True"
                      AutoGenerateColumns="False"
                      CanUserAddRows="False"
                      CanUserDeleteRows="False"
                      CanUserReorderColumns="False"
                      CanUserResizeRows="False"
                      SelectionMode="Single"
                      SelectionUnit="FullRow"
                      HeadersVisibility="Column"
                      GridLinesVisibility="Horizontal"
                      AutomationProperties.Name="Recent QSOs"
                      TabIndex="9">
                <DataGrid.Columns>
                    <DataGridTextColumn Header="Time UTC" Binding="{Binding Time}" Width="*"/>
                    <DataGridTextColumn Header="Call" Binding="{Binding Call}" Width="1.5*"/>
                    <DataGridTextColumn Header="Mode" Binding="{Binding Mode}" Width="0.8*"/>
                    <DataGridTextColumn Header="Freq" Binding="{Binding Freq}" Width="1.5*"/>
                    <DataGridTextColumn Header="RST Sent" Binding="{Binding RSTSent}" Width="*"/>
                    <DataGridTextColumn Header="RST Rcvd" Binding="{Binding RSTRcvd}" Width="*"/>
                    <DataGridTextColumn Header="Name" Binding="{Binding Name}" Width="1.5*"/>
                </DataGrid.Columns>
            </DataGrid>
        </DockPanel>
    </DockPanel>
</UserControl>
